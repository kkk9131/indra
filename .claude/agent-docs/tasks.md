# indra - タスク一覧

## タスク概要

| Phase    | 機能                    | タスク数 | 重要度 | 状態   |
| -------- | ----------------------- | -------- | ------ | ------ |
| Phase 1  | 基盤構築                | 12       | 必須   | ✅完了 |
| Phase 2  | LLM統合                 | 4        | 必須   | ✅完了 |
| Phase 3  | SNS連携 + 承認フロー    | 10       | 高     | 進行中 |
| Phase 4  | ニュース + レポート     | 9        | 高     | 未着手 |
| Phase 5  | Discord/GitHub連携      | 8        | 中     | 未着手 |
| Phase 6  | 動画/画像生成           | 7        | 中     | 未着手 |
| Phase 7  | ログ・分析              | 6        | 横断   | 未着手 |
| Phase 8  | 足場計算・作図          | 6        | 低     | 未着手 |
| Phase 9  | スケジュール + ダッシュ | 6        | 中     | 未着手 |
| Phase 10 | マルチエージェント      | 6        | 後期   | 未着手 |

---

## フェーズ依存関係図

```
Phase 1 ──→ Phase 2 ──→ Phase 3 ──┬──→ Phase 4
  基盤        LLM         SNS      │     ニュース
                                   │
                                   ├──→ Phase 5 ──→ Phase 7
                                   │    Discord      ログ分析
                                   │    GitHub
                                   │
                                   ├──→ Phase 6
                                   │    メディア生成
                                   │
                                   ├──→ Phase 8
                                   │    足場
                                   │
                                   └──→ Phase 9 ──→ Phase 10
                                        スケジュール  マルチAgent
```

### 依存関係詳細

| Phase    | 依存先  | 理由                                 |
| -------- | ------- | ------------------------------------ |
| Phase 4  | Phase 3 | SNS投稿にニュースを活用              |
| Phase 5  | Phase 3 | Discord/GitHubから投稿指示を受付     |
| Phase 6  | Phase 3 | 生成メディアをSNS投稿に添付          |
| Phase 7  | Phase 5 | Discord/GitHub連携ログも収集対象     |
| Phase 8  | Phase 3 | 承認フローを足場作図にも適用         |
| Phase 9  | Phase 3 | SNS投稿のスケジュール機能            |
| Phase 10 | Phase 9 | スケジュール実行にマルチエージェント |

---

## Phase 1: 基盤構築 ✅ 完了

### P1-1: プロジェクト初期化

| ID     | タスク                         | 重要度 | 依存   | 状態 |
| ------ | ------------------------------ | ------ | ------ | ---- |
| P1-1-1 | pnpm monorepo セットアップ     | 必須   | -      | [x]  |
| P1-1-2 | TypeScript設定 (tsconfig.json) | 必須   | P1-1-1 | [x]  |
| P1-1-3 | Vitest設定                     | 必須   | P1-1-2 | [x]  |
| P1-1-4 | Oxlint/Oxfmt設定               | 中     | P1-1-1 | [x]  |

### P1-2: CLI基本構成

| ID     | タスク                  | 重要度 | 依存           | 状態 |
| ------ | ----------------------- | ------ | -------------- | ---- |
| P1-2-1 | Commander基本構成       | 必須   | P1-1-2         | [x]  |
| P1-2-2 | @clack/prompts統合      | 必須   | P1-2-1         | [x]  |
| P1-2-3 | `indra chat` コマンド   | 必須   | P1-2-2, P1-4-2 | [x]  |
| P1-2-4 | `indra config` コマンド | 必須   | P1-2-2         | [x]  |

### P1-3: Web UI基本構成

| ID     | タスク                      | 重要度 | 依存           | 状態 |
| ------ | --------------------------- | ------ | -------------- | ---- |
| P1-3-1 | Vite + Lit プロジェクト作成 | 必須   | P1-1-1         | [x]  |
| P1-3-2 | 接続状態表示コンポーネント  | 必須   | P1-3-1, P1-4-2 | [x]  |
| P1-3-3 | チャットUIコンポーネント    | 必須   | P1-3-2         | [x]  |

### P1-4: Gateway基本構成

| ID     | タスク                  | 重要度 | 依存   | 状態 |
| ------ | ----------------------- | ------ | ------ | ---- |
| P1-4-1 | Hono + ws サーバー基盤  | 必須   | P1-1-2 | [x]  |
| P1-4-2 | WebSocketプロトコル実装 | 必須   | P1-4-1 | [x]  |
| P1-4-3 | セッション管理・永続化  | 必須   | P1-4-2 | [x]  |

---

## Phase 2: LLM統合 ✅ 完了

### P2-1: Claude Agent SDK

| ID     | タスク               | 重要度 | 依存   | 状態 |
| ------ | -------------------- | ------ | ------ | ---- |
| P2-1-1 | Claude Agent SDK統合 | 必須   | P1-4-3 | [x]  |

### P2-2: ストリーミング対応

| ID     | タスク                       | 重要度 | 依存   | 状態 |
| ------ | ---------------------------- | ------ | ------ | ---- |
| P2-2-1 | ストリーミングプロトコル拡張 | 必須   | P2-1-1 | [x]  |
| P2-2-2 | CLI: ストリーミング表示      | 必須   | P2-2-1 | [x]  |
| P2-2-3 | Web UI: ストリーミング表示   | 必須   | P2-2-1 | [x]  |

---

## Phase 3: SNS連携 + 承認フロー（進行中）

### P3-0: Skills統合（Agent SDK）

| ID     | タスク                            | 重要度 | 依存   | 状態 |
| ------ | --------------------------------- | ------ | ------ | ---- |
| P3-0-1 | sns-post Skill定義                | 必須   | P2-1-1 | [ ]  |
| P3-0-2 | agent-sdk.ts Skills有効化         | 必須   | P3-0-1 | [ ]  |
| P3-0-3 | Skillsテスト（devlog→投稿文生成） | 必須   | P3-0-2 | [ ]  |

### P3-1: SNSコネクター

| ID     | タスク                        | 重要度 | 依存   | 状態 |
| ------ | ----------------------------- | ------ | ------ | ---- |
| P3-1-1 | SNSコネクターインターフェース | 必須   | P2-1-1 | [x]  |
| P3-1-2 | X (Twitter) API v2 コネクター | 必須   | P3-1-1 | [x]  |
| P3-1-3 | note コネクター               | 中     | P3-1-1 | [ ]  |

### P3-2: 投稿作成

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P3-2-1 | 投稿生成プロンプト設計     | 必須   | P3-0-1 | [x]  |
| P3-2-2 | CLI: `indra post create`   | 必須   | P3-2-1 | [x]  |
| P3-2-3 | Web UI: 投稿プレビュー画面 | 必須   | P3-2-1 | [x]  |

### P3-3: 承認フロー

| ID     | タスク                           | 重要度 | 依存           | 状態 |
| ------ | -------------------------------- | ------ | -------------- | ---- |
| P3-3-1 | 承認キュー管理 (ファイルベース)  | 必須   | P3-2-1         | [x]  |
| P3-3-2 | CLI: `indra post approve/reject` | 必須   | P3-3-1         | [x]  |
| P3-3-3 | Web UI: 承認キュー表示           | 必須   | P3-3-1         | [x]  |
| P3-3-4 | 投稿実行 (承認後)                | 必須   | P3-3-1, P3-1-2 | [x]  |

### P3-4: UI ↔ Gateway連携

| ID     | タスク                    | 重要度 | 依存   | 状態 |
| ------ | ------------------------- | ------ | ------ | ---- |
| P3-4-1 | UI用WebSocketクライアント | 必須   | P3-3-1 | [ ]  |
| P3-4-2 | approval-page Gateway接続 | 必須   | P3-4-1 | [ ]  |
| P3-4-3 | 型定義統一 (UI↔Backend)   | 必須   | P3-4-1 | [ ]  |

---

## Phase 4: ニュース取得 + レポート生成

### P4-1: ニュースソース

| ID     | タスク                  | 重要度 | 依存   | 状態 |
| ------ | ----------------------- | ------ | ------ | ---- |
| P4-1-1 | ニュースソースIF定義    | 高     | P3-3-4 | [ ]  |
| P4-1-2 | RSSフィードパーサー     | 高     | P4-1-1 | [ ]  |
| P4-1-3 | NewsAPI連携             | 高     | P4-1-1 | [ ]  |
| P4-1-4 | Webスクレイピング基盤   | 中     | P4-1-1 | [ ]  |
| P4-1-5 | SNSトレンド取得 (X API) | 中     | P4-1-1 | [ ]  |

### P4-2: レポート生成

| ID     | タスク                   | 重要度 | 依存   | 状態 |
| ------ | ------------------------ | ------ | ------ | ---- |
| P4-2-1 | AI要約プロンプト設計     | 高     | P4-1-2 | [ ]  |
| P4-2-2 | CLI: `indra news fetch`  | 高     | P4-2-1 | [ ]  |
| P4-2-3 | CLI: `indra news report` | 高     | P4-2-1 | [ ]  |
| P4-2-4 | Web UI: ニュースフィード | 中     | P4-2-1 | [ ]  |

---

## Phase 5: Discord/GitHub連携

### P5-1: Discord連携

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P5-1-1 | Discord Bot基盤            | 中     | P3-3-4 | [ ]  |
| P5-1-2 | 通知送信機能               | 中     | P5-1-1 | [ ]  |
| P5-1-3 | コマンド受付・ルーティング | 中     | P5-1-1 | [ ]  |
| P5-1-4 | CLI: `indra discord send`  | 中     | P5-1-2 | [ ]  |

### P5-2: GitHub連携

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P5-2-1 | GitHub App/Webhook受信     | 中     | P3-3-4 | [ ]  |
| P5-2-2 | Issue/PRコメント送信       | 中     | P5-2-1 | [ ]  |
| P5-2-3 | Webhook→Indraコマンド変換  | 中     | P5-2-1 | [ ]  |
| P5-2-4 | CLI: `indra github notify` | 中     | P5-2-2 | [ ]  |

---

## Phase 6: 動画/画像生成

### P6-1: Remotion統合

| ID     | タスク                   | 重要度 | 依存   | 状態 |
| ------ | ------------------------ | ------ | ------ | ---- |
| P6-1-1 | Remotionプロジェクト設定 | 中     | P3-3-4 | [ ]  |
| P6-1-2 | テンプレートシステム     | 中     | P6-1-1 | [ ]  |
| P6-1-3 | CLI: `indra media video` | 中     | P6-1-2 | [ ]  |
| P6-1-4 | Web UI: 動画プレビュー   | 中     | P6-1-2 | [ ]  |

### P6-2: 画像生成

| ID     | タスク                   | 重要度 | 依存   | 状態 |
| ------ | ------------------------ | ------ | ------ | ---- |
| P6-2-1 | 画像生成API連携          | 中     | P3-3-4 | [ ]  |
| P6-2-2 | CLI: `indra media image` | 中     | P6-2-1 | [ ]  |
| P6-2-3 | Web UI: 画像プレビュー   | 中     | P6-2-1 | [ ]  |

---

## Phase 7: ログ・分析

### P7-1: ログ収集

| ID     | タスク                   | 重要度 | 依存   | 状態 |
| ------ | ------------------------ | ------ | ------ | ---- |
| P7-1-1 | ログ収集基盤             | 横断   | P5-2-1 | [ ]  |
| P7-1-2 | Indra操作ログ記録        | 横断   | P7-1-1 | [ ]  |
| P7-1-3 | 外部サービス連携ログ記録 | 横断   | P7-1-1 | [ ]  |

### P7-2: 分析・レポート

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P7-2-1 | CLI: `indra log search`    | 横断   | P7-1-2 | [ ]  |
| P7-2-2 | Web UI: 統計ダッシュボード | 横断   | P7-1-2 | [ ]  |
| P7-2-3 | 定期分析レポート生成       | 横断   | P7-2-1 | [ ]  |

---

## Phase 8: 足場計算・作図

### P8-1: 割付計算

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P8-1-1 | 割付計算エンジン           | 低     | P3-3-4 | [ ]  |
| P8-1-2 | CLI: `indra scaffold calc` | 低     | P8-1-1 | [ ]  |
| P8-1-3 | Web UI: 計算入力フォーム   | 低     | P8-1-1 | [ ]  |

### P8-2: DXF連携

| ID     | タスク                       | 重要度 | 依存   | 状態 |
| ------ | ---------------------------- | ------ | ------ | ---- |
| P8-2-1 | DXFパーサー/ジェネレーター   | 低     | P8-1-1 | [ ]  |
| P8-2-2 | CLI: `indra scaffold draw`   | 低     | P8-2-1 | [ ]  |
| P8-2-3 | CLI: `indra scaffold import` | 低     | P8-2-1 | [ ]  |

---

## Phase 9: スケジュール + ダッシュボード

### P9-1: スケジューラー

| ID     | タスク                         | 重要度 | 依存   | 状態 |
| ------ | ------------------------------ | ------ | ------ | ---- |
| P9-1-1 | cronベーススケジューラー       | 中     | P3-3-4 | [ ]  |
| P9-1-2 | CLI: `indra schedule add/list` | 中     | P9-1-1 | [ ]  |
| P9-1-3 | Web UI: スケジュールカレンダー | 中     | P9-1-1 | [ ]  |

### P9-2: ダッシュボード

| ID     | タスク                     | 重要度 | 依存   | 状態 |
| ------ | -------------------------- | ------ | ------ | ---- |
| P9-2-1 | メトリクス収集基盤         | 中     | P7-1-1 | [ ]  |
| P9-2-2 | CLI: `indra status`        | 中     | P9-2-1 | [ ]  |
| P9-2-3 | Web UI: 統合ダッシュボード | 中     | P9-2-1 | [ ]  |

---

## Phase 10: マルチエージェント

### P10-1: マルチエージェント基盤

| ID      | タスク                   | 重要度 | 依存    | 状態 |
| ------- | ------------------------ | ------ | ------- | ---- |
| P10-1-1 | エージェント管理システム | 後期   | P9-1-1  | [ ]  |
| P10-1-2 | サブエージェント実行機構 | 後期   | P10-1-1 | [ ]  |
| P10-1-3 | タスク分散アルゴリズム   | 後期   | P10-1-2 | [ ]  |

### P10-2: UI対応

| ID      | タスク                        | 重要度 | 依存    | 状態 |
| ------- | ----------------------------- | ------ | ------- | ---- |
| P10-2-1 | CLI: エージェント管理コマンド | 後期   | P10-1-1 | [ ]  |
| P10-2-2 | Web UI: エージェント一覧      | 後期   | P10-1-1 | [ ]  |
| P10-2-3 | Web UI: フロー可視化          | 後期   | P10-1-3 | [ ]  |

---

## 重要度の定義

| レベル | 説明                              |
| ------ | --------------------------------- |
| 必須   | 基盤、他タスクの依存元            |
| 高     | 主要ユースケース（SNS、ニュース） |
| 中     | 外部連携、運用効率化              |
| 横断   | 全機能に関わるログ・分析          |
| 低     | 専門機能（足場）                  |
| 後期   | スケーラビリティ、高度な機能      |

## クリティカルパス

主要ユースケース達成に必要な経路:

```
P1-1-1 → P1-1-2 → P1-4-1 → P1-4-2 → P1-4-3
                      ↓
                  P2-1-1 (AgentSDK) → P2-2-1
                      ↓
                  P3-1-1 → P3-1-2 → P3-3-4
                      ↓
              ┌──────┴──────┐
              ↓             ↓
          P4-1-1        P5-1-1
         (ニュース)    (Discord)
              ↓             ↓
          P4-2-1        P5-1-3
              ↓             ↓
          P4-2-3        P7-1-1
                       (ログ分析)
```

- Phase 1-2: 完了済み ✅
- Phase 3: 進行中（残: Skills統合、UI連携）
- Phase 4, 5: 次の優先対象
