# indra - 要件定義

## 1. 機能要件

### 1.1 MVP機能

| ID    | 機能               | 説明                                     | 優先度 |
| ----- | ------------------ | ---------------------------------------- | ------ |
| F-001 | CLI基本操作        | エージェントへのメッセージ送信、設定管理 | 必須   |
| F-002 | Gateway            | WebSocketサーバー、セッション管理        | 必須   |
| F-003 | Web UI             | チャット画面、ダッシュボード             | 必須   |
| F-004 | マルチLLM対応      | Claude/OpenAI/Gemini/Ollama切替          | 必須   |
| F-005 | 投稿作成支援       | X/note向けコンテンツ生成                 | 必須   |
| F-006 | 投稿承認フロー     | 生成内容の確認・編集・承認               | 必須   |
| F-007 | スケジュール投稿   | 日時指定での投稿予約                     | 中     |
| F-008 | マルチエージェント | 複数エージェント同時実行                 | 後期   |

### 1.2 SNS連携要件

| プラットフォーム | API                  | 機能                       |
| ---------------- | -------------------- | -------------------------- |
| X (Twitter)      | X API v2             | ツイート投稿、スレッド作成 |
| note             | note API / Web自動化 | 記事投稿、下書き保存       |

### 1.3 承認フロー

```
エージェントが投稿を生成
        ↓
  承認キューに追加
        ↓
 CLI or Web UIで確認
        ↓
  承認 / 編集 / 却下
        ↓
    （承認時）投稿実行
```

- 自動投稿は**禁止**（常に承認必須）
- 編集後の再承認も可能

## 2. 非機能要件

| ID     | 要件               | 仕様                                  |
| ------ | ------------------ | ------------------------------------- |
| NF-001 | データローカリティ | 全データを `~/.indra/` に保存         |
| NF-002 | 認証情報保護       | `~/.indra/credentials/` で暗号化保存  |
| NF-003 | 拡張性             | プラグイン機構でSNS追加可能           |
| NF-004 | オフライン動作     | Ollama使用時はネット不要              |
| NF-005 | マルチクライアント | CLI/Web UIが同一Gatewayに同時接続可能 |

## 3. LLMプロバイダー要件

| プロバイダー | モデル例         | 接続方式         | 備考                         |
| ------------ | ---------------- | ---------------- | ---------------------------- |
| Anthropic    | Claude 4 / Opus  | Claude Agent SDK | ツール使用、エージェント機能 |
| OpenAI       | Codex / GPT-4o   | Codex SDK        | ツール使用、エージェント機能 |
| GitHub       | Copilot          | Copilot SDK      | ツール使用、エージェント機能 |
| Google       | Gemini Pro/Ultra | API Key / OAuth  | REST API                     |
| Ollama       | Llama, Mistral等 | ローカル HTTP    | 認証不要                     |

### 3.1 エージェントSDKの利点

**Claude Agent SDK / Codex SDK / Copilot SDK 共通:**

- **ツール使用**: ファイル操作、コマンド実行、Web検索等
- **マルチターン**: 複雑なタスクの自律的な実行
- **コンテキスト管理**: 長いセッションの効率的な処理
- **サブエージェント**: 専門タスクの委譲

### 3.2 プロバイダー切替

設定で切替可能、デフォルトプロバイダーの指定も可能。
エージェントSDK（Claude / Codex / Copilot）はエージェント機能が必要な場合に推奨。

**注意**: Copilot SDKはGitHub Copilot有料購読が必要。
