# Research Report Workflow

## Phase 1: トピック分析・検索クエリ設計

### 目的

ユーザーの調査依頼を分析し、効果的な検索クエリを設計する。

### 手順

1. **ディレクトリ作成**

   ```bash
   mkdir -p agent-output/research-{YYYYMMDD}-{topic}/work
   ```

2. **トピック分析**
   - ユーザーの依頼内容を明確化
   - 調査の範囲・深さを決定
   - 必要な情報カテゴリを特定

3. **検索クエリ設計**
   - メインキーワード + 関連キーワード
   - 異なる角度からのクエリ（定義、事例、比較、最新動向など）
   - 日本語・英語両方のクエリ（必要に応じて）

4. **成果物**: `work/search-queries.md`

---

## Phase 2: 情報収集 (Codex)

### 目的

Codexを使用して複数の観点から情報を収集する。

### 手順（useCodex=true、デフォルト）

1. **assign-codexスキルを呼び出し**

   ```
   Skill: assign-codex
   args: "--task '以下のトピックについてWeb検索で情報収集して: {topic}' --context '{search-queries.mdの内容}'"
   ```

2. **Codexの結果を保存**
   - `work/raw-sources.md`に保存

### 手順（useCodex=false）

1. **WebSearch実行**

   ```
   WebSearch: "{検索クエリ1}"
   WebSearch: "{検索クエリ2}"
   WebSearch: "{検索クエリ3}"
   ```

2. **情報の記録**
   - 情報の要約
   - ソースURL
   - 信頼性の評価

3. **成果物**: `work/raw-sources.md`

### ベストプラクティス

- 最低3つ以上の異なるクエリで検索
- 公式情報源を優先的に参照
- 最新情報を得るため、日付を含むクエリも検討
- 複数の視点（賛否両論など）を収集

---

## Phase 3: 情報整理・分析 (Codex)

### 目的

収集した情報を整理・分析し、レポートの構成を決定する。

### 手順（useCodex=true、デフォルト）

1. **assign-codexスキルを呼び出し**

   ```
   Skill: assign-codex
   args: "--task '以下の情報を分析し、レポート構成を提案して' --context '{raw-sources.mdの内容}'"
   ```

2. **Codexの分析結果を保存**
   - `work/analysis.md`に保存

### 手順（useCodex=false）

1. **情報の分類**
   - 主要な発見事項
   - 詳細情報
   - 補足情報
   - 信頼性の低い情報（除外候補）

2. **重複・矛盾の確認**
   - 複数ソースで一致する情報を優先
   - 矛盾する情報がある場合は両論併記を検討

3. **構成の決定**: レポートの見出し構成を決定

4. **成果物**: `work/analysis.md`

---

## Phase 4: レポート作成 (Claude)

### 目的

Codexの分析結果を基に、Claudeが構造化されたレポートを作成する。

### 執筆ガイドライン

- 客観的・中立的な記述を心がける
- 主張には出典を明記する
- 専門用語は必要に応じて説明を付ける
- 箇条書きと段落を適切に使い分ける
- 数値データがある場合は具体的に記載

→ レポート構成: `report-template.md`

---

## Phase 5: 保存・納品

### 手順

1. **レポートの最終確認**
   - 誤字脱字のチェック
   - リンク切れがないか確認
   - 構成の一貫性を確認

2. **ファイル保存**
   ```
   agent-output/research-{YYYYMMDD}-{topic}/report.md
   ```

---

## カスタマイズポイント

ユーザーの要望に応じて以下をカスタマイズ可能：

- レポートの詳細度（簡潔版 / 詳細版）
- フォーカスする観点（技術面 / ビジネス面 / 比較分析など）
- 出力形式（Markdownのみ / 要約付きなど）
- 追加セクション（SWOT分析、タイムラインなど）
